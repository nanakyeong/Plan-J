<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Kakao Map</title>
  <style>
    html, body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        width: 100%;
        height: 100%;
    }
    #map {
        width: 100%;
        height: 100%;
    }
  </style>
  <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=717bb0e96399df26123f9decca5a9795&libraries=services"></script>
</head>
<body>
<div id="map"></div>
<script>
  var mapContainer = document.getElementById('map');

  function displayRoute(optimizedPaths, markerData, centerLat, centerLng) {
      var mapOption = {
          center: new kakao.maps.LatLng(centerLat, centerLng),
          level: 9
      };
      var map = new kakao.maps.Map(mapContainer, mapOption);

      // Function to add a marker at a specific position
      function addMarker(position) {
          new kakao.maps.Marker({
              position: position,
              map: map
          });
      }

      try {
          var data = JSON.parse(optimizedPaths);
          var markers = JSON.parse(markerData);
          var linePath = [];

          data.forEach(roads => {
              roads.forEach(road => {
                  var vertexes = road.vertexes;
                  for (var i = 0; i < vertexes.length; i += 2) {
                      var lat = vertexes[i + 1];
                      var lng = vertexes[i];
                      var latLng = new kakao.maps.LatLng(lat, lng);
                      linePath.push(latLng);
                  }
              });
          });

          // 주요 좌표에만 마커 추가
          markers.forEach(marker => {
              var position = new kakao.maps.LatLng(marker.y, marker.x);
              addMarker(position);
          });

          // Draw the path on the map
          var polyline = new kakao.maps.Polyline({
              path: linePath,
              strokeWeight: 5,
              strokeColor: '#FF0000',
              strokeOpacity: 0.8
          });
          polyline.setMap(map);
      } catch (error) {
          console.error("Error displaying route:", error);
      }
  }
</script>

</body>
</html>
